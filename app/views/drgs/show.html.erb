<div class='row'>
  <div class="span7">
    <h3>DRG <%= @drg.code %> - <%= @drg.description %></h3>
    <p class="lead"><%= @costs.count %> hospitals reported data on this DRG in 2011. Average covered charges was <%= number_to_currency(@average_covered_charges, :unit => "$") %> and average total payments was <%= number_to_currency(@average_total_payments, :unit => "$") %>.</p>
    <p><%= link_to "Data definitions and source", "#definitions" %><br/><%= link_to "Additional information about DRGs", "http://www.cms.gov/icd10manual/version30-fullcode-cms/P0002.html", :target => "blank" %></p>

  </div>
  <div class="span5">
  </div>
</div>


<table id="sortTable" class="table table-striped table-border table-hover" style="height:200px;overflow:scroll;">
<thead>
  <tr>
    <th>Hospital</th>
    <th>Discharges</th>
    <th>Avg. Covered Charges</th>
    <th>Avg. Total Payments</th>
  </tr>
</thead>
<tbody>
<% @costs.each do |cost| %>
  <tr>
    <td><%= link_to cost.hospital.name, cost.hospital %></td>
    <td><%= cost.total_discharges %></td>
    <td><%= number_to_currency(cost.average_covered_charges, :unit => "$") %></td>
    <td><%= number_to_currency(cost.average_total_payments, :unit => "$") %></td>
  </tr>
<% end %>
</tbody>
</table>

<%= render "shared/pager" %>

<%= render "shared/definitions" %>


<script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Hospital',<% @costs.each do |cost| %>'<%= cost.hospital.name %>',<% end %>],
          [1,<% @costs.each do |cost| %><%= cost.average_total_payments %>,<% end %>]
        ]);

        var options = {
          title: 'Company Performance',
          hAxis: {title: 'Year', titleTextStyle: {color: 'red'}}
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        //chart.draw(data, options);
      }
    </script>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>


<script>
$(document).ready(function() { 
		$("#costTable")
			.tablesorter({widthFixed: true, widgets: ['zebra']})
			.tablesorterPager({container: $("#pager")});
}); 
</script>
