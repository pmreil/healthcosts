<% title @drg.uc_description %>
<% description @drg.uc_description+' average chargemaster costs and medicare payments across US hospitals. Compare hospital costs in the US' %>
<% keywords @drg.uc_description+','+"chargemaster rates, medicare rates, compare health costs, most expensive hospitals" %>

<div class='row'>
  <div class="span9">
    <h3>DRG <%= @drg.code %> - <%= @drg.uc_description %></h3>
    <p class="lead"><%= @costs.count %> hospitals reported data on this DRG in 2011. Average covered charges was <%= number_to_currency(@average_covered_charges, :unit => "$") %> and average total payments was <%= number_to_currency(@average_total_payments, :unit => "$") %>. Highest charge <%= number_to_currency(@costs.first.average_covered_charges, :unit => "$") %></p>
  </div>
  <div class="span3">
    <br/>
    <p><a href="#discuss" class="btn btn-small btn-primary">Discuss this DRG</a></p>
    <p><a href="#definitions" class="btn btn-small btn-primary">Data source and definitions</a></p>
    <p><a href="http://www.cms.gov/icd10manual/version30-fullcode-cms/P0002.html" target="_blank" class="btn btn-small btn-primary">Information about DRGs</a></p>

  </div>
</div>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-0066874388719652";
/* hcc970 */
google_ad_slot = "8636594082";
google_ad_width = 970;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<table id="sortTable" class="table table-striped table-border table-hover" style="height:200px;overflow:scroll;">
<thead>
  <tr>
    <th>Hospital</th>
    <th>Discharges</th>
    <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount hospital charged for this DRG in 2011 over total discharges">Average Covered Charge</a></th>
    <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount Medicare paid the hospital for the procedure">Average Total Payment</a></th>

  </tr>
</thead>
<tbody>
<% @costs.each do |cost| %>
  <tr>
    <td><%= link_to cost.hospital.uc_name+", "+cost.hospital.city.capitalize+", "+cost.hospital.state, cost.hospital %></td>
    <td><%= cost.total_discharges %></td>
    <td><%= number_to_currency(cost.average_covered_charges, :unit => "$") %></td>
    <td><%= number_to_currency(cost.average_total_payments, :unit => "$") %></td>
  </tr>
<% end %>
</tbody>
</table>

<%= render "shared/pager" %>

<h3>Discuss <%= @drg.uc_description %></h3>
<%= render "shared/disqus" %>

<%= render "shared/definitions" %>

<script>
$(document).ready(function() { 
		$("#costTable")
			.tablesorter({widthFixed: true, widgets: ['zebra']})
			.tablesorterPager({container: $("#pager")});

    $('.link').tooltip();
    $(".link").click(function() {
      return false;
    });

});
</script> 

$(document).ready(function() {
  // call the tablesorter plugin and apply the uitheme widget
  $("#sortTable").tablesorter({
    // this will apply the bootstrap theme if "uitheme" widget is included
    // the widgetOptions.uitheme is no longer required to be set
    theme : "bootstrap",

    widthFixed: true,

    headerTemplate : '{content} {icon}', // new in v2.7. Needed to add the bootstrap icon!

    // widget code contained in the jquery.tablesorter.widgets.js file
    // use the zebra stripe widget if you plan on hiding any rows (filter widget)
    widgets : [ "uitheme", "filter", "zebra" ],

    widgetOptions : {
      // using the default zebra striping class name, so it actually isn't included in the theme variable above
      // this is ONLY needed for bootstrap theming if you are using the filter widget, because rows are hidden
      zebra : ["even", "odd"],

      // reset filters button
      filter_reset : ".reset"

      // set the uitheme widget to use the bootstrap theme class names
      // this is no longer required, if theme is set
      // ,uitheme : "bootstrap"

    }
  })
  .tablesorterPager({

    // target the pager markup - see the HTML block below
    container: $(".pager"),

    // target the pager page select dropdown - choose a page
    cssGoto  : ".pagenum",

    // remove rows from the table to speed up the sort of large tables.
    // setting this to false, only hides the non-visible rows; needed if you plan to add/remove rows with the pager enabled.
    removeRows: false,

    // output string - default is '{page}/{totalPages}';
    // possible variables: {page}, {totalPages}, {filteredPages}, {startRow}, {endRow}, {filteredRows} and {totalRows}
    output: '{startRow} - {endRow} / {filteredRows} ({totalRows})'

  });
});

</script> 
