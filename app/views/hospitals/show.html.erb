<% title @hospital.uc_name %>
<% description @hospital.uc_name+' average Chargemaster costs and Medicare payments' %>
<% keywords 'Member login page.' %>

<div class="row">
  <div class="span4">
    <h3><%= link_to @hospital.uc_name, "http://www.google.com/search?q="+@hospital.name+"&btnI", :target => "_blank" %></h3>
    <p><%= @hospital.address %></br><%= @hospital.city %>, <%= @hospital.state %> <%= @hospital.zipcode %></p>
    <p><b>Region:</b> : <%= @hospital.referral_region %></p>
    <p><a href="#discuss" class="btn btn-small btn-primary">Discuss <%= @hospital.uc_name %></a></p>
    <p><a href="#news" class="btn btn-small btn-primary">News about <%= @hospital.uc_name %></a></p>
    <p><a href="#definitions" class="btn btn-small btn-primary">Data source and definitions</a></p>

<span class='st_sharethis_large' displayText='ShareThis'></span>
<span class='st_facebook_large' displayText='Facebook'></span>
<span class='st_twitter_large' displayText='Tweet'></span>
<span class='st_wordpress_large' displayText='WordPress'></span>
<span class='st_tumblr_large' displayText='Tumblr'></span>
<span class='st_linkedin_large' displayText='LinkedIn'></span>
<span class='st_googleplus_large' displayText='Google +'></span>
<span class='st_email_large' displayText='Email'></span>

  </div>
  <div class="span8">
    <div id="map-canvas"></div>
  </div>
</div>

<br/>

<table id="sortTable" class="table table-striped table-hover table-bordered">
<thead>
  <th>Description</th>
  <th>Total Discharges</th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount hospital charged for this DRG in 2011 over total discharges">Average Covered Charge</a></th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount Medicare paid the hospital for the procedure">Average Total Payment</a></th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Difference between what hospital charged and Medicare paid the hospital for the procedure">Difference<br/>(% Markup)</a></th>

</thead>
<tbody>
<% @costs.each do |cost| %>
<tr>
  <td><%= link_to cost.drg.description, cost.drg %></td>
  <td><%= cost.total_discharges %></td>
  <td style="text-align:right;"><%= number_to_currency(cost.average_covered_charges, :unit => "$") %></td>
  <td align="right"><%= number_to_currency(cost.average_total_payments, :unit => "$") %></td>
  <td align="right"><nobr><%= number_to_currency((cost.average_covered_charges - cost.average_total_payments), :unit => '$') %> (<%= number_to_percentage(((cost.average_covered_charges*100)/cost.average_total_payments), :precision => 0) %>)</nobr>`</td>
</tr>
<% end %>
</tbody>
</table>

<%= render "shared/pager" %>

<h3>Discuss <%= @hospital.uc_name %></h3>
<%= render "shared/disqus" %>

<h3>News about <%= @hospital.uc_name %></h3>
<a name="news"></a>
<div id="latestNews"></div>

<%= render "shared/definitions" %>

<script type="text/javascript">

$(document).ready(function() {
  $('.link').tooltip();
  $(".link").click(function() {
    return false;
  });

  $('#latestNews').FeedEk({
    FeedUrl : 'https://news.google.com/news/feeds?q="<%= @hospital.name %>"&ie=UTF-8&output=rss',
    MaxCount : 15,
    ShowDesc : false,
    ShowPubDate:true,
    DescCharacterLimit:100,
    TitleLinkTarget:'_blank'
  });

});

var map;
google.maps.visualRefresh = true;
function initialize() {
  var myLatLng = new google.maps.LatLng(<%= @hospital.latitude %>, <%= @hospital.longitude %>);
  var mapOptions = {
    zoom: 16,
    center: myLatLng,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    panControl: true,
    streetViewControl: true,
    overviewMapControl: true
  };
  map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);
  var marker = new google.maps.Marker({
      position: myLatLng,
      map: map
  });
}

google.maps.event.addDomListener(window, 'load', initialize);
</script> 