<% title @hospital.uc_name %>
<% description @hospital.uc_name+' average chargemaster costs and medicare payments. Compare hospital costs in the US' %>
<% keywords @hospital.uc_name+','+@hospital.city+' '+@hospital.state+','+"chargemaster rates, medicare rates, compare health costs, most expensive hospitals" %>

<div class="row">
  <div class="span5">
    <h3><%= link_to @hospital.uc_name, "http://www.google.com/search?q="+@hospital.name+"&btnI", :target => "_blank" %></h3>
    <p><%= @hospital.uc_address %></br><%= @hospital.city.capitalize %>, <%= @hospital.state %> <%= @hospital.zipcode %></p>
    <p><b>Region:</b> : <%= @hospital.referral_region %></p>
    <p><a href="#discuss" class="btn btn-small btn-primary">Discuss <%= @hospital.uc_name %></a></p>
    <p><a href="#news" class="btn btn-small btn-primary">News about <%= @hospital.uc_name %></a></p>
    <p><a href="#definitions" class="btn btn-small btn-primary">Data source and definitions</a></p>

<%= render "shared/share" %>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-0066874388719652";
/* hcc468 */
google_ad_slot = "2450459687";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

  </div>
  <div class="span7">
    <br/><div id="map-canvas"></div>
  </div>
</div>

<br/>

<div class="row">

<div class="span10">
<table id="sortTable" class="table table-striped table-hover table-bordered">
<thead>
  <th>Description</th>
  <th>Hosptial's Total 2011 Cases</th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount hospital charged for this DRG in 2011 over total discharges">Hospital's Average Covered Charge</a></th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount nationally charged for this DRG in 2011 over total discharges">National Average Covered Charge</a></th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount Medicare paid the hospital for the procedure">Medicare's Hospital Average Total Reimbursement</a></th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Average amount Medicare paid the nation for the procedure">Medicare's National Average Total Reimbursement</a></th>
  <th><a href="#" class="link" rel="tooltip" data-original-title="Difference between what hospital charged and Medicare paid the hospital for the procedure">Difference<br/>(% Markup)</a></th>

</thead>
<tbody>
<% @costs.each do |cost| %>
<tr>
  <td><%= link_to cost.drg.uc_description, cost.drg %></td>
  <td><%= cost.total_discharges %></td>
  <td style="text-align:right;"><%= number_to_currency(cost.average_covered_charges, :unit => "$") %></td>
  <td style="text-align:right;"><%= number_to_currency(cost.drg.avg_covered_charges, :unit => "$") %></td>
  <td style="text-align:right;"><%= number_to_currency(cost.average_total_payments, :unit => "$") %></td>
  <td style="text-align:right;"><%= number_to_currency(cost.drg.avg_total_payments, :unit => "$") %></td>
  <td align="right"><nobr><%= number_to_currency((cost.average_covered_charges - cost.average_total_payments), :unit => '$') %> (<%= number_to_percentage(((cost.average_covered_charges*100)/cost.average_total_payments), :precision => 0) %>)</nobr>`</td>
</tr>
<% end %>
</tbody>
</table>
</div>
<div class="span2">
  <script type="text/javascript"><!--
google_ad_client = "ca-pub-0066874388719652";
/* 160vertical */
google_ad_slot = "5403926082";
google_ad_width = 160;
google_ad_height = 600;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div>

<%= render "shared/pager" %>

<h3>Discuss <%= @hospital.uc_name %></h3>
<%= render "shared/disqus" %>

<h3>News about <%= @hospital.uc_name %></h3>
<a name="news"></a>
<div id="latestNews"></div>

<%= render "shared/definitions" %>

<script type="text/javascript">

$(document).ready(function() {
  $('.link').tooltip();
  $(".link").click(function() {
    return false;
  });

  $('#latestNews').FeedEk({
    FeedUrl : 'https://news.google.com/news/feeds?q="<%= @hospital.name %>"&ie=UTF-8&output=rss',
    MaxCount : 15,
    ShowDesc : false,
    ShowPubDate:true,
    DescCharacterLimit:100,
    TitleLinkTarget:'_blank'
  });

  loadMaps();



  // call the tablesorter plugin and apply the uitheme widget
  $("#sortTable").tablesorter({
    // this will apply the bootstrap theme if "uitheme" widget is included
    // the widgetOptions.uitheme is no longer required to be set
    theme : "bootstrap",

    widthFixed: true,

    headerTemplate : '{content} {icon}', // new in v2.7. Needed to add the bootstrap icon!

    // widget code contained in the jquery.tablesorter.widgets.js file
    // use the zebra stripe widget if you plan on hiding any rows (filter widget)
    widgets : [ "uitheme", "filter", "zebra" ],

    widgetOptions : {
      // using the default zebra striping class name, so it actually isn't included in the theme variable above
      // this is ONLY needed for bootstrap theming if you are using the filter widget, because rows are hidden
      zebra : ["even", "odd"],

      // reset filters button
      filter_reset : ".reset"

      // set the uitheme widget to use the bootstrap theme class names
      // this is no longer required, if theme is set
      // ,uitheme : "bootstrap"

    }
  })
  .tablesorterPager({

    // target the pager markup - see the HTML block below
    container: $(".pager"),

    // target the pager page select dropdown - choose a page
    cssGoto  : ".pagenum",

    // remove rows from the table to speed up the sort of large tables.
    // setting this to false, only hides the non-visible rows; needed if you plan to add/remove rows with the pager enabled.
    removeRows: false,

    // output string - default is '{page}/{totalPages}';
    // possible variables: {page}, {totalPages}, {filteredPages}, {startRow}, {endRow}, {filteredRows} and {totalRows}
    output: '{startRow} - {endRow} / {filteredRows} ({totalRows})'

  });
});

function loadMaps() {
  google.load("maps", "3", {other_params:'sensor=false', "callback" : initialize});
  var map;
  google.maps.visualRefresh = true;
}

function initialize() {
  var myLatLng = new google.maps.LatLng(<%= @hospital.latitude %>, <%= @hospital.longitude %>);
  var mapOptions = {
    zoom: 16,
    center: myLatLng,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    panControl: true,
    streetViewControl: true,
    overviewMapControl: true
  };
  map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);
  var marker = new google.maps.Marker({
      position: myLatLng,
      map: map
  });
}

</script> 